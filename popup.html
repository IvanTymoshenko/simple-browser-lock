<!DOCTYPE html>
<html>
<head>
    <style>
        /* Popup Body (Dark Theme, Fixed Size) */
        body { 
            width: 360px; 
            height: 100vh; 
            padding: 25px; 
            font-family: 'Segoe UI', sans-serif; 
            background: #252538; 
            color: #cdd6f4; 
            overflow: hidden; 
            margin: 0 auto; 
            box-sizing: border-box; 
        }
        .hidden { display: none; }
        
        /* Headers */
        h3 { margin-top: 10px; text-align: center; color: #fff; font-size: 22px; margin-bottom: 10px; font-weight: 600; }
        p { font-size: 14px; color: #a6adc8; margin-bottom: 25px; line-height: 1.5; text-align: center; }
        
        /* Inputs */
        input { 
            width: 100%; margin-bottom: 15px; padding: 14px; box-sizing: border-box; 
            border: 2px solid #313244; background: #181825; color: white;
            border-radius: 8px; font-size: 15px; outline: none; transition: 0.3s;
        }
        input:focus { border-color: #89b4fa; }

        /* Buttons */
        button { 
            width: 100%; padding: 14px; background: #89b4fa; color: #1e1e2e; border: none; 
            border-radius: 8px; cursor: pointer; font-weight: bold; margin-top: 8px; 
            font-size: 15px; transition: 0.2s; 
        }
        button:hover { background: #b4befe; transform: translateY(-2px); }
        
        button.lock-btn { background: #f38ba8; margin-bottom: 25px; padding: 16px; font-size: 17px; color: #1e1e2e; }
        button.lock-btn:hover { background: #eba0b3; }

        button.secondary-btn {
            background: transparent; border: 2px solid #45475a; color: #a6adc8; margin-top: 15px;
        }
        button.secondary-btn:hover { background: #313244; color: #fff; transform: none; }

        /* Recovery Box */
        .recovery-box { background: #313244; border: 2px dashed #f9e2af; padding: 20px; border-radius: 8px; margin-top: 15px; text-align: center; }
        .code-display { font-family: monospace; font-size: 22px; font-weight: bold; color: #f9e2af; letter-spacing: 2px; margin: 15px 0; display: block; background: #181825; padding: 12px; border-radius: 6px; }
        
        .divider { border-top: 1px solid #45475a; margin: 25px 0; }
        .status-msg { margin-top: 15px; font-size: 13px; text-align: center; font-weight: bold; min-height: 20px; }
        .error-msg { color: #f38ba8; }
        .success-msg { color: #a6e3a1; }

        .link-btn { 
            background: none; color: #a6adc8; font-size: 13px; margin-top: 15px; 
            text-decoration: underline; padding: 5px; width: 100%; text-align: center;
            border: none; cursor: pointer; transform: none;
        }
        .link-btn:hover { background: none; color: #89b4fa; transform: none; }
    </style>
</head>
<body>
    <div id="view-setup" class="hidden">
        <h3>Welcome!</h3>
        <p>Let's secure your browser. Create a master password to protect your tabs.</p>
        
        <input type="password" id="setup-pass" placeholder="New Password">
        <input type="password" id="setup-confirm" placeholder="Confirm Password">
        <button id="btn-save">Save & Protect</button>
        <button id="btn-later" class="secondary-btn">Maybe Later</button>
        
        <div id="setup-msg" class="status-msg"></div>

        <div id="recovery-result" class="hidden">
            <div class="recovery-box">
                <strong style="color: #f9e2af;">IMPORTANT: Recovery Code</strong>
                <p style="margin-bottom: 10px;">This is the ONLY way to restore access if you forget your password.</p>
                <span id="new-recovery-code" class="code-display">---</span>
                <p style="font-size: 11px; margin-bottom: 0;">Write this down safely.</p>
            </div>
            <button id="btn-finish-setup" style="background: #a6e3a1; color: #1e1e2e; margin-top: 15px;">I have saved it</button>
        </div>
    </div>

    <div id="view-dashboard" class="hidden">
        <button id="btn-lock-now" class="lock-btn">Lock Browser Now</button>
        <div class="divider"></div>
        
        <h3 style="font-size: 16px;">Change Password</h3>
        <input type="password" id="change-old" placeholder="Current Password">
        <input type="password" id="change-new" placeholder="New Password">
        <input type="password" id="change-confirm" placeholder="Confirm New">
        
        <button id="btn-change">Update Password</button>
        <button id="btn-goto-recovery" class="link-btn">Forgot Password?</button>
        
        <div id="dashboard-msg" class="status-msg"></div>
    </div>

    <div id="view-recovery" class="hidden">
        <h3 style="color: #f9e2af;">Reset Password</h3>
        <p>Enter your 6-digit recovery code.</p>
        
        <div class="recovery-box" style="margin-top: 0; margin-bottom: 20px; background: transparent; border: none; padding: 0;">
            <input type="text" id="recovery-input" placeholder="123456" maxlength="6" style="text-align: center; letter-spacing: 5px; font-weight: bold; font-size: 20px; margin-bottom: 0; border-color: #f9e2af;">
        </div>

        <button id="btn-reset-confirm" style="background: #f9e2af; color: #333;">Reset Password</button>
        <button id="btn-back-dashboard" class="link-btn">Cancel</button>
        
        <div id="recovery-msg" class="status-msg"></div>
    </div>
    
    <script src="popup.js"></script>
</body>
</html>